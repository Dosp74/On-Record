<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://fonts.googleapis.com/css?family=Pretendard&display=swap" rel="stylesheet">
    <title>반려친구 등록</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }
      
      body, html {
        width: 100%;
        height: 100%;
        display: flex; 
        justify-content: center; 
        align-items: center; 
        font-family: 'Pretendard', sans-serif;
      }

      body {
          padding-top: 70px; /* 네비게이션 바의 높이만큼 여백을 추가 */
      }
      
      /* 배경 이미지 설정 */
      .background {
        position: fixed; 
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-image: url('companion_form.png'); /* 실제 배경 이미지 경로 */
        background-size: cover;
        background-position: center;
        z-index: -1; /* 배경이 다른 콘텐츠 뒤에 오도록 설정 */
      }
      
      /* 네비게이션 바 */
      .header-navbar {
        position: fixed; /* 네비게이션 바 고정 */
        top: 0;
        left: 0;
        width: 100%;
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 10px 30px;
        background-color: #FFFBED; /* 연한 노란색 */
        box-shadow: 0 4px 10px 1px rgba(0, 0, 0, 0.07); /* 피그마에서 설정한 그림자 */
        z-index: 1; /* 배경 이미지보다 위에 표시 */
      }
      
      .navbar-text {
        font-size: 18px;
        margin: 0 10px;
        color: #FFC100;
      }
      span{
          margin: 0 15px;
      }
      .navbar-logo {
        height: 40px; /* 로고 크기 설정 */
      }

      .container {
          max-width: 800px;
          margin: 20px;
          padding: 50px;
          border-radius: 15px;
          box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
          background-color: rgba(255, 255, 255, 0.12);
          backdrop-filter: blur(30px);
          display: flex;
          flex-wrap: wrap;
          gap: 20px;
          align-items: center;
          justify-content: center;
          flex-direction: column;
      }
      .form-title {
        color: rgba(0,0,0,1);
        opacity: 1;
        text-align: center;
        font-weight: normal;
        font-size: 28px;
      }
      .form-body {
        display: flex; 
        flex-direction: row; /* 왼쪽 오른쪽 배치 */
        width: 100%; /* 너비를 100%로 */
        justify-content: space-between;
        align-items: flex-start;
      }
      .image-upload {
        position: relative; /* 수정된 부분 */
        width: 200px;
        height: 200px;
        flex-shrink: 0;
        margin-right: 20px;
      }
      .image-upload input {
        display: none;
      }
      .image-upload label {
          display: flex;
          width: 100%;
          height: 100%;
          border-radius: 50%;
          background: #d9d9d9;
          align-items: center;
          justify-content: center;
          cursor: pointer;
          overflow: hidden;
      }

      #pet-preview {
        width: 100%;
        height: 100%;
        object-fit: cover;
        border-radius: 50%;
        display: none; /* 기본적으로 숨김 */
      }

      .form-fields {
        flex-grow: 1;
        display: flex;
        flex-direction: column;
        gap: 15px;
        margin-left: 20px;
      }
      .form-group {
          margin: 25px;
      }
      label {
          font-weight: bold;
          margin: 5px;
      }
      input, select {
          width: 100%;
          padding: 8px;
          border: 1px solid #ccc;
          border-radius: 5px;
      }
      
      #personality-buttons {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        justify-content: center; /* 수정된 부분 */
        width: 100%
      }
      .personality-btn {
          padding: 5px 10px;
          border: 1px solid #666;
          background: white;
          border-radius: 15px;
          cursor: pointer;
      }
      .personality-btn.selected {
          background: #ffcc00;
      }
      .submit-btn {
          display: block;
          padding: 5px 20px;
          background: linear-gradient(60deg, #FFE28A, #FFC100);
          border: none;
          color: white;
          font-size: 16px;
          border-radius: 30px;
          cursor: pointer;
      }
      .submit-btn:hover {
          background: #e5b700;
      }

      /* 추가된 스타일 */
      .centered-content {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        gap: 20px;
      }
      
      @media (max-width: 600px) {
          .container {
              flex-direction: column;
              align-items: center;
          }
      }
    </style>
</head>
<body>
    <div class="background"></div>
      <header class="header-navbar">
          <img class="navbar-logo" src="온기록-logo.svg" alt="Logo" />
          <div class="navbar-text">
              <span>모두의 온기록</span>
              <span>마이페이지</span>
          </div>
      </header>
    <div class="container">
        <h1 class="form-title"><strong>{{ user.username }}님의 반려친구</strong>에 대해 알려주세요!</h1>
        <div class="form-body">
          <div class="image-upload">
            <label for="pet-image">
                <img id="pet-preview" src="#" alt="미리보기">
            </label>
            <input type="file" id="pet-image" name="pet-image" accept="image/*">
          </div>
          <div class="form-fields">
              <form method="POST" action="{% url 'diaries:friend_create' %}" enctype="multipart/form-data">
                  {% csrf_token %}
                  <div class="form-group">
                      <label>이름</label>
                      {{ form.name }}
                  </div>
                  <div class="form-group">
                      <label>종류</label>
                      {{ form.kind }}
                  </div>
                  <div class="form-group">
                      <label>성별</label>
                      {{ form.gender }}
                  </div>
                  <div class="form-group">
                      <label>나이</label>
                      {{ form.age }}
                  </div>
              </form>
          </div>
        </div>

        <!-- 성격과 반려친구 등록 버튼 부분을 중앙에 배치 -->
        <div class="centered-content">
          <div class="form-group">
              <label>성격:</label>
              <div id="personality-buttons">
                  {% for personality in form.personal.field.queryset %}
                      <button type="button" class="personality-btn" data-value="{{ personality.id }}">{{ personality.type }}</button>
                  {% endfor %}
              </div>
          </div>
          <input type="hidden" name="personal" id="selected-personalities">
          <button type="submit" class="submit-btn">반려친구 등록</button>
        </div>
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const buttons = document.querySelectorAll(".personality-btn");
            const selectedInput = document.getElementById("selected-personalities");
            let selectedValues = new Set();

            buttons.forEach(button => {
                button.addEventListener("click", function (e) {
                    e.preventDefault();
                    const value = this.getAttribute("data-value");

                    if (selectedValues.has(value)) {
                        selectedValues.delete(value);
                        this.classList.remove("selected");
                    } else {
                        selectedValues.add(value);
                        this.classList.add("selected");
                    }
                    selectedInput.value = Array.from(selectedValues).join(",");
                });
            });
        });
    </script>
</body>
</html>
