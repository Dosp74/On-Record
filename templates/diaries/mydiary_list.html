{% extends 'base.html' %}
{% load static %}

{% block style %}
<link rel="stylesheet" href="{% static 'css/mydiary-list.css' %}">
{% endblock %}

{% block content %}
<div>
    <div class="background-b"></div>
    <h1 class="title">{{ friend_name }}이와 함께 한 온기록</h1>
    
    <div class="header">
        <button class="friend-btn">{{ friend_name|slice:":10" }}{% if friend_name|length > 10 %}...{% endif %}</button>
        <a href="{% url 'diaries:view_calendar' %}">
            <button class="add-diary-btn">온기록 남기기</button>
        </a>
    </div>

    <div class="container">
        <div class="diary-list">
            {% if diaries %}
                {% for diary in diaries %}
                <a href="{% url 'diaries:detail_diaries' diary.id %}" class="diary-card-link">
                    <div class="diary-card">
                        <div class="diary-image">
                            <img src="{% if diary.image %}{{ diary.image.url }}{% else %}/static/images/default_pet.jpg{% endif %}" alt="오늘의 사진">
                        </div>
                        <div class="diary-info">
                            <h2 class="diary-title">{{ diary.title }}</h2>
                            <p class="diary-preview">
                                {% if diary.content|length > 47 %}
                                {{ diary.content|slice:":47" }}...
                                {% else %}
                                {{ diary.content }}
                                {% endif %}
                            </p>
                        </div>
                        <div class="diary-actions">
                            <button class="like-btn" data-diary-id="{{ diaries.id }}">
                                {% if is_liked %}
                                    <i class="bi bi-heart-fill"></i>
                                {% else %}
                                    <i class="bi bi-heart"></i>
                                {% endif %}
                                <span id="like-count-{{ diaries.id }}">{{ diaries.like_set.count }}</span>
                            </button>
                        
                            <button class="comment-btn" data-diary-id="{{ diaries.id }}">
                                <i class="bi bi-chat-dots"></i>
                                <span id="comment-count-{{ diaries.id }}">{{ diaries.comment_set.count }}</span>
                            </button>
                        </div>
                    </div>
                </a>
                {% endfor %}
            {% else %}
                <p style="text-align: center; color: #999; grid-column: span 3;">등록된 온기록이 없습니다.</p>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}